{% extends "base.html" %}

{% block title %}All Events{% endblock %}

{% block content %}
    <div>
        <h1 class="text-xl text-center">Upcoming Events</h1>
        
        {% if user.is_authenticated and user.is_moderator %}
            <a href="{% url 'event_create' %}">
                + Create New Event
            </a>
        {% endif %}
    </div>

    {% if events %}
        <div class="space-y-6 shadow-2xl p-2">
            {% for event in events %}
                <div>
                    <div>
                        <div>
                            <h2>
                                <a href="{% url 'event_detail' event.pk %}">{{ event.title }}</a>
                            </h2>
                            <p>
                                By {{ event.creator.username }}
                            </p>
                        </div>
                        <div class="text-right">
                            <p>{{ event.date_time|date:"M d, Y" }}</p>
                            <p>{{ event.date_time|time:"H:i" }}</p>
                        </div>
                    </div>
                    
                    <p>{{ event.description }}</p>
                    
                    <div>

                        {{ event.location }}
                        
                        <a href="{% url 'event_detail' event.pk %}">
                            View Details
                        </a>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="space-y-6 shadow-2xl p-2 border rounded-xl border-gray-300">
            <p>No events found. Be the first to create one!</p>
            {% if user.is_authenticated and user.is_moderator %}
                <a href="{% url 'event_create' %}">
                    Create Event
                </a>
            {% elif user.is_authenticated %}
                <p>You need moderator access to create events.</p>
            {% else %}
                <p>Please <a href="{% url 'login' %}" class="text-indigo-600">log in</a> to view events.</p>
            {% endif %}
        </div>
    {% endif %}
{% endblock %}